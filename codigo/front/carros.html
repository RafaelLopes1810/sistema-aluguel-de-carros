<!DOCTYPE html>
<html lang="pt-BR">

<head>
Â  <meta charset="UTF-8">
Â  <title>Carros DisponÃ­veis</title>
Â  <link rel="stylesheet" href="style.css">
</head>

<body>
Â  <header class="navbar">
Â  Â  <div class="logo">ðŸš— AlugaCar</div>
Â  Â  <nav>
Â  Â  Â  <a href="index.html">InÃ­cio</a>
Â  Â  Â  <a href="login.html">Login</a>
Â  Â  Â  <a href="carros.html" class="ativo">Carros</a>
Â  Â  Â  <a href="pedidos.html">Meus Pedidos</a>
Â  Â  Â  <a href="perfil.html">Perfil</a>
Â  Â  </nav>
Â  </header>

Â  <main>
Â  Â  Â  Â  <button id="admin-btn" style="display:none;" onclick="window.location.href='cadastroCarro.html'">
Â  Â  Â  âž• Cadastrar Novo Carro
Â  Â  </button>

Â  Â  <section class="destaques">
Â  Â  Â  <h2>Carros DisponÃ­veis</h2>
Â  Â  Â  <div class="card-container"></div>
Â  Â  </section>
Â  </main>

Â  <footer>
Â  Â  <p>Â© 2025 AlugaCar - Todos os direitos reservados.</p>
Â  </footer>

Â  <script>
Â  Â  const apiUrl = "http://localhost:8080/api/carros";
Â  Â  const pedidosApiUrl = "http://localhost:8080/api/pedidos";
Â  Â  const cardContainer = document.querySelector(".card-container");

Â  Â  // Pega informaÃ§Ãµes do usuÃ¡rio logado
Â  Â  const clienteId = localStorage.getItem("clienteId");
Â  Â  const clienteEmail = localStorage.getItem("clienteEmail");
Â  Â  const isAdmin = (clienteEmail === "admin"); // Ou "admin@alugacar.com.br"

Â  Â  // FunÃ§Ã£o para exibir o botÃ£o de admin
Â  Â  function verificarAdmin() {
Â  Â  Â  if (isAdmin) {
Â  Â  Â  Â  document.getElementById("admin-btn").style.display = "block";
Â  Â  Â  }
Â  Â  }

Â  Â  // FunÃ§Ã£o para carregar carros
Â  Â  async function carregarCarros() {
Â  Â  Â  try {
Â  Â  Â  Â  const response = await fetch(apiUrl);
Â  Â  Â  Â  const carros = await response.json();

Â  Â  Â  Â  cardContainer.innerHTML = "";

Â  Â  Â  Â  if (carros.length === 0) {
Â  Â  Â  Â  Â  cardContainer.innerHTML = "<p>Nenhum carro disponÃ­vel no momento.</p>";
Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }

Â  Â  Â  Â  carros.forEach(carro => {
Â  Â  Â  Â  Â  const card = document.createElement("div");
Â  Â  Â  Â  Â  card.className = "card";
Â  Â  Â  Â  Â  card.innerHTML = `
Â  Â  Â  Â  Â  Â  <img class="car-img" src="${carro.foto}" alt="${carro.nome}">
Â  Â  Â  Â  Â  Â  <h3>${carro.nome}</h3>
Â  Â  Â  Â  Â  Â  <p>Ano: ${carro.ano} | Placa: ${carro.placa}</p>
Â  Â  Â  Â  Â  Â  ${!isAdmin ? `<button onclick="alugarCarro(${carro.id})">Alugar</button>` : ""}
Â  Â  Â  Â  Â  Â  ${isAdmin ? `<button onclick="deletarCarro(${carro.id})">Excluir</button>` : ""}
Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  cardContainer.appendChild(card);
Â  Â  Â  Â  });
Â  Â  Â  } catch (error) {
Â  Â  Â  Â  console.error("Erro ao carregar carros:", error);
Â  Â  Â  Â  cardContainer.innerHTML = "<p>Erro ao carregar carros do servidor.</p>";
Â  Â  Â  }
Â  Â  }

Â  Â  // FunÃ§Ã£o para excluir carro (apenas admin)
Â  Â  async function deletarCarro(id) {
Â  Â  Â  if (confirm("Tem certeza que deseja excluir este carro?")) {
Â  Â  Â  Â  await fetch(`${apiUrl}/${id}`, { method: "DELETE" });
Â  Â  Â  Â  carregarCarros();
Â  Â  Â  }
Â  Â  }

Â  Â  // FunÃ§Ã£o para alugar carro (criar pedido)
Â  Â  async function alugarCarro(carroId) {
Â  Â  Â  if (!clienteId) {
Â  Â  Â  Â  alert("VocÃª precisa estar logado para alugar um carro!");
Â  Â  Â  Â  window.location.href = "login.html";
Â  Â  Â  Â  return;
Â  Â  Â  }

Â  Â  Â  try {
Â  Â  Â  Â  const response = await fetch(`${pedidosApiUrl}?clienteId=${clienteId}&carroId=${carroId}`, {
Â  Â  Â  Â  Â  method: "POST"
Â  Â  Â  Â  });

Â  Â  Â  Â  if (response.ok) {
Â  Â  Â  Â  Â  alert("Pedido de aluguel criado com sucesso! VocÃª pode acompanhar em 'Meus Pedidos'.");
Â  Â  Â  Â  Â  window.location.href = "pedidos.html";
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  alert("Erro ao criar pedido de aluguel.");
Â  Â  Â  Â  }
Â  Â  Â  } catch (error) {
Â  Â  Â  Â  console.error("Erro ao criar pedido:", error);
Â  Â  Â  Â  alert("Erro de conexÃ£o com servidor.");
Â  Â  Â  }
Â  Â  }

Â  Â  // Chama a funÃ§Ã£o de verificaÃ§Ã£o e de carregar carros
Â  Â  verificarAdmin();
Â  Â  carregarCarros();
Â  </script>

Â  <script src="script.js"></script>
</body>

</html>